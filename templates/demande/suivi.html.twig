{# check if commande has transaction  #}
{% if commande.transaction is not null %}
    {% set currentTransaction = commande.transaction %}
{% else %}
{# check if demande has been payed yet #}
    {% set currentTransaction = commande.demande.transaction %}
{% endif %}
{% set span0 = '<span class=""></span>' %}    
{% set span1 = '<span class=""></span>' %}    
{% set span2 = '<span class=""></span>' %}

{# check if commande has already demande #}
{% if commande.demande is not null %}
    {% set demande = commande.demande %}
    {% if 
        demande.statusDoc == constant('App\\Entity\\Demande::DOC_WAITTING') 
    %}
        {% set span0 = '<span class="arrowBig_"></span>' %}    
        {% set span1 = '<span class=""></span>' %}    
        {% set span2 = '<span class=""></span>' %}
    {% endif %}
    {% if 
        demande.statusDoc == constant('App\\Entity\\Demande::DOC_PENDING') or
        demande.statusDoc == constant('App\\Entity\\Demande::DOC_NONVALID') or
        demande.statusDoc == constant('App\\Entity\\Demande::RETRACT_DEMAND') or
        demande.statusDoc == constant('App\\Entity\\Demande::RETRACT_REFUND') or
        demande.statusDoc == constant('App\\Entity\\Demande::DOC_UNCOMPLETED')
    %}
        {% set span0 = '<span class="btn btn-green ok_btn">OK !</span>' %}    
        {% set span1 = '<span class="arrowBig_"></span>' %}    
        {% set span2 = '<span class=""></span>' %}
    {% endif %}
    {% if 
        demande.statusDoc == constant('App\\Entity\\Demande::DOC_VALID') or
        demande.statusDoc == constant('App\\Entity\\Demande::DOC_RECEIVE_VALID') or
        demande.statusDoc == constant('App\\Entity\\Demande::RETRACT_FORM_WAITTING') or
        demande.statusDoc == constant('App\\Entity\\Demande::DOC_VALID_SEND_TMS')
    %}
        {% set span0 = '<span class="btn btn-green ok_btn">OK !</span>' %}    
        {% set span1 = '<span class="btn btn-green ok_btn">OK !</span>' %}    
        {% set span2 = '<span class="arrowBig_"></span>' %}
    {% endif %}
{% endif %}



<div class="suiviBlock">
    <div class="container">
        <div class="row justify-content-center">
            {# the status when client has payed his commande #}
            <div class="column_5">
                {% if currentTransaction is not null %} 
                <span class="btn btn-green ok_btn">OK !</span>
                {% else %}
                <span class="arrowBig_"></span>
                {% endif %}
                <div>
                    <button type="button" class="box_" data-container="body" data-toggle="popover" data-html="true" data-placement="bottom" data-trigger="hover click" data-content="J’ai effectué le paiement, il a été accepté.">
                    J’ai payé
                    </button>
                </div>
            </div>
            {# the status when client has already fill the demande form #}
            <div class="column_5">
                {% if commande.demande is not null %} 
                <span class="btn btn-green ok_btn">OK !</span>
                {% else %}
                <span class="arrowBig_"></span>
                {% endif %}
                <div>
                    <button type="button" class="box_" data-container="body" data-toggle="popover" data-html="true" data-placement="bottom" data-trigger="hover click" data-content="Après mon paiement, j’ai rempli le formulaire en rentrant les informations nécessaires à ma démarche.">
                    J’ai rempli le formulaire
                    </button>
                </div>
            </div>
            {# the status when client has already upload his document #}
            <div class="column_5">
                {{span0 | raw}}
                <div>
                    <button type="button" class="box_" data-container="body" data-toggle="popover" data-html="true" data-placement="bottom" data-trigger="hover click" data-content="<div>J’ai numérisé les documents nécessaires à ma démarche, et je les ai transmis à CG Officiel depuis <a href='{{ path('espace_client') }}'>l’espace client</a></div>">
                    J’ai numérisé mes documents
                    </button>
                </div>
            </div>
            {# the status when client has already send his document in sent to the post #}
            <div class="column_5">
                {{span1 | raw}}
                <div>
                    <button type="button" class="box_" data-container="body" data-toggle="popover" data-html="true" data-placement="bottom" data-trigger="hover click" data-content="J’ai envoyé mes documents par courrier, j’attends la validation de mon dossier ">
                    J’envoie mes documents par courrier
                    </button>
                </div>
            </div>
            {# status when client still waitting his car card #}
            <div class="column_5">
                {{span2 | raw}}
                <div>
                    <button type="button" class="box_" data-container="body" data-toggle="popover" data-html="true" data-placement="bottom" data-trigger="hover click" data-content="J’attends ma carte grise ">
                    <img src='{{ asset('asset/img/cg.png') }}' style='width:50%; margin:auto' alt='carte-grise'>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>